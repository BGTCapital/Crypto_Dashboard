2021-08-21 21:37:49,185 : WARNING : EXX.ws.23: encountered connection issue server rejected WebSocket connection: HTTP 404 - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 58, in _create_connection
    async with self.conn.connect() as connection:
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\contextlib.py", line 171, in __aenter__
    return await self.gen.__anext__()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 114, in connect
    await self._open()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 287, in _open
    self.conn = await websockets.connect(self.address, **self.ws_kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\client.py", line 629, in __await_impl__
    await protocol.handshake(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\client.py", line 388, in handshake
    raise InvalidStatusCode(status_code)
websockets.exceptions.InvalidStatusCode: server rejected WebSocket connection: HTTP 404
2021-08-21 21:37:49,297 : ERROR : KUCOIN.ws.34: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 233, in message_handler
    await self._process_l2_book(msg, symbol, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 193, in _process_l2_book
    await self._snapshot(symbol)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 157, in _snapshot
    headers = generate_token(self.key_id, self.key_secret, self.key_passphrase, str_to_sign)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\auth\kucoin.py", line 19, in generate_token
    signature = base64.b64encode(hmac.new(key_secret.encode('utf-8'), str_to_sign.encode('utf-8'), hashlib.sha256).digest())
TypeError: 'AttrDict' object is not callable
2021-08-21 21:37:51,316 : WARNING : COINBASE: Missing sequence number detected for BTC-USD. Received 28512112344, expected 28512112270
2021-08-21 21:37:51,316 : WARNING : COINBASE: Resetting data for BTC-USD
2021-08-21 21:37:51,413 : WARNING : EXX.ws.23: encountered connection issue server rejected WebSocket connection: HTTP 404 - reconnecting in 2.0 seconds...
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 58, in _create_connection
    async with self.conn.connect() as connection:
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\contextlib.py", line 171, in __aenter__
    return await self.gen.__anext__()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 114, in connect
    await self._open()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 287, in _open
    self.conn = await websockets.connect(self.address, **self.ws_kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\client.py", line 629, in __await_impl__
    await protocol.handshake(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\client.py", line 388, in handshake
    raise InvalidStatusCode(status_code)
websockets.exceptions.InvalidStatusCode: server rejected WebSocket connection: HTTP 404
2021-08-21 21:37:51,502 : ERROR : KUCOIN.ws.34: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 233, in message_handler
    await self._process_l2_book(msg, symbol, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 193, in _process_l2_book
    await self._snapshot(symbol)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 157, in _snapshot
    headers = generate_token(self.key_id, self.key_secret, self.key_passphrase, str_to_sign)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\auth\kucoin.py", line 19, in generate_token
    signature = base64.b64encode(hmac.new(key_secret.encode('utf-8'), str_to_sign.encode('utf-8'), hashlib.sha256).digest())
TypeError: 'AttrDict' object is not callable
2021-08-21 21:37:53,516 : ERROR : KUCOIN.ws.34: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 233, in message_handler
    await self._process_l2_book(msg, symbol, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 193, in _process_l2_book
    await self._snapshot(symbol)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 157, in _snapshot
    headers = generate_token(self.key_id, self.key_secret, self.key_passphrase, str_to_sign)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\auth\kucoin.py", line 19, in generate_token
    signature = base64.b64encode(hmac.new(key_secret.encode('utf-8'), str_to_sign.encode('utf-8'), hashlib.sha256).digest())
TypeError: 'AttrDict' object is not callable
2021-08-21 21:37:54,461 : ERROR : COINBASE.ws.21: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 355, in message_handler
    await self._book_snapshot([pair])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 240, in _book_snapshot
    await self.book_callback(self._l3_book[npair], L3_BOOK, npair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 237, in book_callback
    await self.callback(L3_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 41, in handle_book
    assert(self.check_books(book))
AssertionError
2021-08-21 21:37:54,573 : WARNING : EXX.ws.23: encountered connection issue server rejected WebSocket connection: HTTP 404 - reconnecting in 4.0 seconds...
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 58, in _create_connection
    async with self.conn.connect() as connection:
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\contextlib.py", line 171, in __aenter__
    return await self.gen.__anext__()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 114, in connect
    await self._open()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 287, in _open
    self.conn = await websockets.connect(self.address, **self.ws_kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\client.py", line 629, in __await_impl__
    await protocol.handshake(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\client.py", line 388, in handshake
    raise InvalidStatusCode(status_code)
websockets.exceptions.InvalidStatusCode: server rejected WebSocket connection: HTTP 404
2021-08-21 21:37:55,425 : ERROR : KUCOIN.ws.34: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 233, in message_handler
    await self._process_l2_book(msg, symbol, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 193, in _process_l2_book
    await self._snapshot(symbol)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 157, in _snapshot
    headers = generate_token(self.key_id, self.key_secret, self.key_passphrase, str_to_sign)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\auth\kucoin.py", line 19, in generate_token
    signature = base64.b64encode(hmac.new(key_secret.encode('utf-8'), str_to_sign.encode('utf-8'), hashlib.sha256).digest())
TypeError: 'AttrDict' object is not callable
2021-08-21 21:37:57,390 : ERROR : KUCOIN.ws.34: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 233, in message_handler
    await self._process_l2_book(msg, symbol, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 193, in _process_l2_book
    await self._snapshot(symbol)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 157, in _snapshot
    headers = generate_token(self.key_id, self.key_secret, self.key_passphrase, str_to_sign)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\auth\kucoin.py", line 19, in generate_token
    signature = base64.b64encode(hmac.new(key_secret.encode('utf-8'), str_to_sign.encode('utf-8'), hashlib.sha256).digest())
TypeError: 'AttrDict' object is not callable
2021-08-21 21:37:59,334 : ERROR : KUCOIN.ws.34: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 233, in message_handler
    await self._process_l2_book(msg, symbol, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 193, in _process_l2_book
    await self._snapshot(symbol)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 157, in _snapshot
    headers = generate_token(self.key_id, self.key_secret, self.key_passphrase, str_to_sign)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\auth\kucoin.py", line 19, in generate_token
    signature = base64.b64encode(hmac.new(key_secret.encode('utf-8'), str_to_sign.encode('utf-8'), hashlib.sha256).digest())
TypeError: 'AttrDict' object is not callable
2021-08-21 21:37:59,815 : WARNING : EXX.ws.23: encountered connection issue server rejected WebSocket connection: HTTP 404 - reconnecting in 8.0 seconds...
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 58, in _create_connection
    async with self.conn.connect() as connection:
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\contextlib.py", line 171, in __aenter__
    return await self.gen.__anext__()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 114, in connect
    await self._open()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 287, in _open
    self.conn = await websockets.connect(self.address, **self.ws_kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\client.py", line 629, in __await_impl__
    await protocol.handshake(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\client.py", line 388, in handshake
    raise InvalidStatusCode(status_code)
websockets.exceptions.InvalidStatusCode: server rejected WebSocket connection: HTTP 404
2021-08-21 21:37:59,816 : ERROR : COINBASE.ws.21: encountered an exception, reconnecting in 2.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 60, in _create_connection
    await self.subscribe(connection)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 397, in subscribe
    await self._book_snapshot(self.subscription[chan])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 240, in _book_snapshot
    await self.book_callback(self._l3_book[npair], L3_BOOK, npair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 237, in book_callback
    await self.callback(L3_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 41, in handle_book
    assert(self.check_books(book))
AssertionError
2021-08-21 21:38:01,295 : ERROR : KUCOIN.ws.34: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 233, in message_handler
    await self._process_l2_book(msg, symbol, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 193, in _process_l2_book
    await self._snapshot(symbol)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 157, in _snapshot
    headers = generate_token(self.key_id, self.key_secret, self.key_passphrase, str_to_sign)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\auth\kucoin.py", line 19, in generate_token
    signature = base64.b64encode(hmac.new(key_secret.encode('utf-8'), str_to_sign.encode('utf-8'), hashlib.sha256).digest())
TypeError: 'AttrDict' object is not callable
2021-08-21 21:38:03,190 : ERROR : KUCOIN.ws.34: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 233, in message_handler
    await self._process_l2_book(msg, symbol, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 193, in _process_l2_book
    await self._snapshot(symbol)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 157, in _snapshot
    headers = generate_token(self.key_id, self.key_secret, self.key_passphrase, str_to_sign)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\auth\kucoin.py", line 19, in generate_token
    signature = base64.b64encode(hmac.new(key_secret.encode('utf-8'), str_to_sign.encode('utf-8'), hashlib.sha256).digest())
TypeError: 'AttrDict' object is not callable
2021-08-21 21:38:05,161 : ERROR : KUCOIN.ws.34: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 233, in message_handler
    await self._process_l2_book(msg, symbol, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 193, in _process_l2_book
    await self._snapshot(symbol)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 157, in _snapshot
    headers = generate_token(self.key_id, self.key_secret, self.key_passphrase, str_to_sign)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\auth\kucoin.py", line 19, in generate_token
    signature = base64.b64encode(hmac.new(key_secret.encode('utf-8'), str_to_sign.encode('utf-8'), hashlib.sha256).digest())
TypeError: 'AttrDict' object is not callable
2021-08-21 21:38:06,667 : ERROR : COINBASE.ws.21: encountered an exception, reconnecting in 4.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 60, in _create_connection
    await self.subscribe(connection)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 397, in subscribe
    await self._book_snapshot(self.subscription[chan])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 240, in _book_snapshot
    await self.book_callback(self._l3_book[npair], L3_BOOK, npair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 237, in book_callback
    await self.callback(L3_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 41, in handle_book
    assert(self.check_books(book))
AssertionError
2021-08-21 21:38:07,097 : ERROR : KUCOIN.ws.34: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 233, in message_handler
    await self._process_l2_book(msg, symbol, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 193, in _process_l2_book
    await self._snapshot(symbol)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 157, in _snapshot
    headers = generate_token(self.key_id, self.key_secret, self.key_passphrase, str_to_sign)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\auth\kucoin.py", line 19, in generate_token
    signature = base64.b64encode(hmac.new(key_secret.encode('utf-8'), str_to_sign.encode('utf-8'), hashlib.sha256).digest())
TypeError: 'AttrDict' object is not callable
2021-08-21 21:38:09,020 : ERROR : KUCOIN.ws.34: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 233, in message_handler
    await self._process_l2_book(msg, symbol, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 193, in _process_l2_book
    await self._snapshot(symbol)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\kucoin.py", line 157, in _snapshot
    headers = generate_token(self.key_id, self.key_secret, self.key_passphrase, str_to_sign)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\auth\kucoin.py", line 19, in generate_token
    signature = base64.b64encode(hmac.new(key_secret.encode('utf-8'), str_to_sign.encode('utf-8'), hashlib.sha256).digest())
TypeError: 'AttrDict' object is not callable
2021-08-21 21:38:09,038 : WARNING : EXX.ws.23: encountered connection issue server rejected WebSocket connection: HTTP 404 - reconnecting in 16.0 seconds...
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 58, in _create_connection
    async with self.conn.connect() as connection:
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\contextlib.py", line 171, in __aenter__
    return await self.gen.__anext__()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 114, in connect
    await self._open()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 287, in _open
    self.conn = await websockets.connect(self.address, **self.ws_kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\client.py", line 629, in __await_impl__
    await protocol.handshake(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\client.py", line 388, in handshake
    raise InvalidStatusCode(status_code)
websockets.exceptions.InvalidStatusCode: server rejected WebSocket connection: HTTP 404
2021-08-22 20:05:50,330 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 16, in book
    new = l2_book[(np.abs(stats.zscore(l2_book)) < 3).all(axis=1)]
NameError: name 'np' is not defined
2021-08-22 20:05:51,552 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 16, in book
    new = l2_book[(np.abs(stats.zscore(l2_book)) < 3).all(axis=1)]
NameError: name 'np' is not defined
2021-08-22 20:05:52,779 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 16, in book
    new = l2_book[(np.abs(stats.zscore(l2_book)) < 3).all(axis=1)]
NameError: name 'np' is not defined
2021-08-22 20:05:53,977 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 16, in book
    new = l2_book[(np.abs(stats.zscore(l2_book)) < 3).all(axis=1)]
NameError: name 'np' is not defined
2021-08-22 20:06:03,865 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 17, in book
    new = l2_book[(np.abs(stats.zscore(l2_book)) < 3).all(axis=1)]
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\scipy\stats\stats.py", line 2474, in zscore
    return zmap(a, a, axis=axis, ddof=ddof, nan_policy=nan_policy)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\scipy\stats\stats.py", line 2544, in zmap
    mn = a.mean(axis=axis, keepdims=True)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\core\_methods.py", line 179, in _mean
    ret = umr_sum(arr, axis, dtype, out, keepdims, where=where)
TypeError: unsupported operand type(s) for +: 'decimal.Decimal' and 'float'
2021-08-22 20:06:05,069 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 17, in book
    new = l2_book[(np.abs(stats.zscore(l2_book)) < 3).all(axis=1)]
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\scipy\stats\stats.py", line 2474, in zscore
    return zmap(a, a, axis=axis, ddof=ddof, nan_policy=nan_policy)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\scipy\stats\stats.py", line 2544, in zmap
    mn = a.mean(axis=axis, keepdims=True)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\core\_methods.py", line 179, in _mean
    ret = umr_sum(arr, axis, dtype, out, keepdims, where=where)
TypeError: unsupported operand type(s) for +: 'decimal.Decimal' and 'float'
2021-08-22 20:06:06,298 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 17, in book
    new = l2_book[(np.abs(stats.zscore(l2_book)) < 3).all(axis=1)]
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\scipy\stats\stats.py", line 2474, in zscore
    return zmap(a, a, axis=axis, ddof=ddof, nan_policy=nan_policy)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\scipy\stats\stats.py", line 2544, in zmap
    mn = a.mean(axis=axis, keepdims=True)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\core\_methods.py", line 179, in _mean
    ret = umr_sum(arr, axis, dtype, out, keepdims, where=where)
TypeError: unsupported operand type(s) for +: 'decimal.Decimal' and 'float'
2021-08-22 20:11:03,345 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 18, in book
    bid_low = l2_book['bid'].quantile(0.01)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\series.py", line 2448, in quantile
    result = df.quantile(q=q, interpolation=interpolation, numeric_only=False)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 10290, in quantile
    res = self.quantile(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 10309, in quantile
    res = data._mgr.quantile(qs=q, axis=1, interpolation=interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\managers.py", line 1345, in quantile
    blocks = [
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\managers.py", line 1346, in <listcomp>
    blk.quantile(axis=axis, qs=qs, interpolation=interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\blocks.py", line 1324, in quantile
    result = quantile_compat(self.values, np.asarray(qs._values), interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\array_algos\quantile.py", line 38, in quantile_compat
    return _quantile_with_mask(values, mask, fill_value, qs, interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\array_algos\quantile.py", line 100, in _quantile_with_mask
    result = nanpercentile(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\nanops.py", line 1716, in nanpercentile
    result = [
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\nanops.py", line 1717, in <listcomp>
    _nanpercentile_1d(val, m, q, na_value, interpolation=interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\nanops.py", line 1670, in _nanpercentile_1d
    return np.percentile(values, q, interpolation=interpolation)
  File "<__array_function__ internals>", line 5, in percentile
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 3867, in percentile
    return _quantile_unchecked(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 3986, in _quantile_unchecked
    r, k = _ureduce(a, func=_quantile_ureduce_func, q=q, axis=axis, out=out,
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 3564, in _ureduce
    r = func(a, **kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 4112, in _quantile_ureduce_func
    r = _lerp(x_below, x_above, weights_above, out=out)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 4011, in _lerp
    lerp_interpolation = asanyarray(add(a, diff_b_a*t, out=out))
TypeError: unsupported operand type(s) for *: 'decimal.Decimal' and 'float'
2021-08-22 20:11:04,558 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 18, in book
    bid_low = l2_book['bid'].quantile(0.01)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\series.py", line 2448, in quantile
    result = df.quantile(q=q, interpolation=interpolation, numeric_only=False)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 10290, in quantile
    res = self.quantile(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 10309, in quantile
    res = data._mgr.quantile(qs=q, axis=1, interpolation=interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\managers.py", line 1345, in quantile
    blocks = [
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\managers.py", line 1346, in <listcomp>
    blk.quantile(axis=axis, qs=qs, interpolation=interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\blocks.py", line 1324, in quantile
    result = quantile_compat(self.values, np.asarray(qs._values), interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\array_algos\quantile.py", line 38, in quantile_compat
    return _quantile_with_mask(values, mask, fill_value, qs, interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\array_algos\quantile.py", line 100, in _quantile_with_mask
    result = nanpercentile(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\nanops.py", line 1716, in nanpercentile
    result = [
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\nanops.py", line 1717, in <listcomp>
    _nanpercentile_1d(val, m, q, na_value, interpolation=interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\nanops.py", line 1670, in _nanpercentile_1d
    return np.percentile(values, q, interpolation=interpolation)
  File "<__array_function__ internals>", line 5, in percentile
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 3867, in percentile
    return _quantile_unchecked(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 3986, in _quantile_unchecked
    r, k = _ureduce(a, func=_quantile_ureduce_func, q=q, axis=axis, out=out,
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 3564, in _ureduce
    r = func(a, **kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 4112, in _quantile_ureduce_func
    r = _lerp(x_below, x_above, weights_above, out=out)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 4011, in _lerp
    lerp_interpolation = asanyarray(add(a, diff_b_a*t, out=out))
TypeError: unsupported operand type(s) for *: 'decimal.Decimal' and 'float'
2021-08-22 20:11:05,811 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 18, in book
    bid_low = l2_book['bid'].quantile(0.01)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\series.py", line 2448, in quantile
    result = df.quantile(q=q, interpolation=interpolation, numeric_only=False)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 10290, in quantile
    res = self.quantile(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 10309, in quantile
    res = data._mgr.quantile(qs=q, axis=1, interpolation=interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\managers.py", line 1345, in quantile
    blocks = [
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\managers.py", line 1346, in <listcomp>
    blk.quantile(axis=axis, qs=qs, interpolation=interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\blocks.py", line 1324, in quantile
    result = quantile_compat(self.values, np.asarray(qs._values), interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\array_algos\quantile.py", line 38, in quantile_compat
    return _quantile_with_mask(values, mask, fill_value, qs, interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\array_algos\quantile.py", line 100, in _quantile_with_mask
    result = nanpercentile(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\nanops.py", line 1716, in nanpercentile
    result = [
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\nanops.py", line 1717, in <listcomp>
    _nanpercentile_1d(val, m, q, na_value, interpolation=interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\nanops.py", line 1670, in _nanpercentile_1d
    return np.percentile(values, q, interpolation=interpolation)
  File "<__array_function__ internals>", line 5, in percentile
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 3867, in percentile
    return _quantile_unchecked(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 3986, in _quantile_unchecked
    r, k = _ureduce(a, func=_quantile_ureduce_func, q=q, axis=axis, out=out,
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 3564, in _ureduce
    r = func(a, **kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 4112, in _quantile_ureduce_func
    r = _lerp(x_below, x_above, weights_above, out=out)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 4011, in _lerp
    lerp_interpolation = asanyarray(add(a, diff_b_a*t, out=out))
TypeError: unsupported operand type(s) for *: 'decimal.Decimal' and 'float'
2021-08-22 20:11:07,016 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 18, in book
    bid_low = l2_book['bid'].quantile(0.01)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\series.py", line 2448, in quantile
    result = df.quantile(q=q, interpolation=interpolation, numeric_only=False)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 10290, in quantile
    res = self.quantile(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 10309, in quantile
    res = data._mgr.quantile(qs=q, axis=1, interpolation=interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\managers.py", line 1345, in quantile
    blocks = [
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\managers.py", line 1346, in <listcomp>
    blk.quantile(axis=axis, qs=qs, interpolation=interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\blocks.py", line 1324, in quantile
    result = quantile_compat(self.values, np.asarray(qs._values), interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\array_algos\quantile.py", line 38, in quantile_compat
    return _quantile_with_mask(values, mask, fill_value, qs, interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\array_algos\quantile.py", line 100, in _quantile_with_mask
    result = nanpercentile(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\nanops.py", line 1716, in nanpercentile
    result = [
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\nanops.py", line 1717, in <listcomp>
    _nanpercentile_1d(val, m, q, na_value, interpolation=interpolation)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\nanops.py", line 1670, in _nanpercentile_1d
    return np.percentile(values, q, interpolation=interpolation)
  File "<__array_function__ internals>", line 5, in percentile
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 3867, in percentile
    return _quantile_unchecked(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 3986, in _quantile_unchecked
    r, k = _ureduce(a, func=_quantile_ureduce_func, q=q, axis=axis, out=out,
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 3564, in _ureduce
    r = func(a, **kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 4112, in _quantile_ureduce_func
    r = _lerp(x_below, x_above, weights_above, out=out)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\numpy\lib\function_base.py", line 4011, in _lerp
    lerp_interpolation = asanyarray(add(a, diff_b_a*t, out=out))
TypeError: unsupported operand type(s) for *: 'decimal.Decimal' and 'float'
2021-08-22 20:14:58,529 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 18, in book
    print(_book['bids'])
KeyError: 'bids'
2021-08-22 20:14:59,734 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 18, in book
    print(_book['bids'])
KeyError: 'bids'
2021-08-22 20:15:00,930 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 18, in book
    print(_book['bids'])
KeyError: 'bids'
2021-08-22 20:15:02,172 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 18, in book
    print(_book['bids'])
KeyError: 'bids'
2021-08-22 20:36:56,176 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 30, in book
    bids = _book['bids']
KeyError: 'bids'
2021-08-22 20:36:57,333 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 30, in book
    bids = _book['bids']
KeyError: 'bids'
2021-08-22 20:36:58,500 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 30, in book
    bids = _book['bids']
KeyError: 'bids'
2021-08-22 20:36:59,680 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 30, in book
    bids = _book['bids']
KeyError: 'bids'
2021-08-22 20:37:00,862 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 30, in book
    bids = _book['bids']
KeyError: 'bids'
2021-08-22 20:40:07,882 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'bids'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 29, in book
    bids = l2_book['bids']
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'bids'
2021-08-22 20:40:09,084 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'bids'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 29, in book
    bids = l2_book['bids']
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'bids'
2021-08-22 20:40:10,498 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'bids'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 29, in book
    bids = l2_book['bids']
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'bids'
2021-08-22 20:40:11,723 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'bids'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 29, in book
    bids = l2_book['bids']
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'bids'
2021-08-22 20:40:12,944 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'bids'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 29, in book
    bids = l2_book['bids']
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'bids'
2021-08-22 20:49:20,665 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
TypeError: __call__() got an unexpected keyword argument 'book'
2021-08-22 20:49:21,833 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
TypeError: __call__() got an unexpected keyword argument 'book'
2021-08-22 20:49:23,057 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
TypeError: __call__() got an unexpected keyword argument 'book'
2021-08-22 20:49:24,225 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
TypeError: __call__() got an unexpected keyword argument 'book'
2021-08-22 20:49:25,456 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
TypeError: __call__() got an unexpected keyword argument 'book'
2021-08-22 20:49:26,623 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
TypeError: __call__() got an unexpected keyword argument 'book'
2021-08-22 20:49:27,795 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
TypeError: __call__() got an unexpected keyword argument 'book'
2021-08-22 20:50:59,799 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
TypeError: __call__() got an unexpected keyword argument 'book'
2021-08-22 20:51:00,975 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
TypeError: __call__() got an unexpected keyword argument 'book'
2021-08-22 20:51:02,140 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
TypeError: __call__() got an unexpected keyword argument 'book'
2021-08-22 20:51:03,312 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
TypeError: __call__() got an unexpected keyword argument 'book'
2021-08-22 22:04:06,597 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'bid'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 53, in book
    print(l2_book['bid'])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'bid'
2021-08-22 22:04:07,798 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'bid'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 53, in book
    print(l2_book['bid'])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'bid'
2021-08-22 22:04:08,997 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'bid'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 53, in book
    print(l2_book['bid'])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'bid'
2021-08-22 22:04:10,183 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'bid'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 53, in book
    print(l2_book['bid'])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'bid'
2021-08-22 22:04:11,388 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'bid'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 53, in book
    print(l2_book['bid'])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'bid'
2021-08-22 22:04:12,608 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'bid'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 53, in book
    print(l2_book['bid'])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'bid'
2021-08-22 22:07:02,862 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in book
    l2_book = pandas.DataFrame.from_dict(_book, columns=['price', 'size'])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 1589, in from_dict
    raise ValueError("cannot use columns parameter with orient='columns'")
ValueError: cannot use columns parameter with orient='columns'
2021-08-22 22:07:04,040 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in book
    l2_book = pandas.DataFrame.from_dict(_book, columns=['price', 'size'])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 1589, in from_dict
    raise ValueError("cannot use columns parameter with orient='columns'")
ValueError: cannot use columns parameter with orient='columns'
2021-08-22 22:07:05,214 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in book
    l2_book = pandas.DataFrame.from_dict(_book, columns=['price', 'size'])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 1589, in from_dict
    raise ValueError("cannot use columns parameter with orient='columns'")
ValueError: cannot use columns parameter with orient='columns'
2021-08-22 22:07:06,377 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in book
    l2_book = pandas.DataFrame.from_dict(_book, columns=['price', 'size'])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 1589, in from_dict
    raise ValueError("cannot use columns parameter with orient='columns'")
ValueError: cannot use columns parameter with orient='columns'
2021-08-22 22:08:10,137 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'bid'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 53, in book
    bids = l2_book['bid'].dropna()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'bid'
2021-08-22 22:08:11,325 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'bid'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 53, in book
    bids = l2_book['bid'].dropna()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'bid'
2021-08-22 22:08:12,515 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'bid'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 53, in book
    bids = l2_book['bid'].dropna()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'bid'
2021-08-22 22:14:14,114 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in book
    bids = pandas.DataFrame.from_dict(_book['bid'], orient='columns')
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 1593, in from_dict
    return cls(data, index=index, columns=columns, dtype=dtype)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 614, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 464, in dict_to_mgr
    return arrays_to_mgr(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 119, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 625, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2021-08-22 22:16:25,060 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in book
    bids_type = pandas.DataFrame(_book['bid'], columns=_book['bid'].keys())
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 614, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 422, in dict_to_mgr
    index = _extract_index(arrays[~missing])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 625, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2021-08-22 22:16:26,275 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in book
    bids_type = pandas.DataFrame(_book['bid'], columns=_book['bid'].keys())
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 614, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 422, in dict_to_mgr
    index = _extract_index(arrays[~missing])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 625, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2021-08-22 22:16:27,484 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in book
    bids_type = pandas.DataFrame(_book['bid'], columns=_book['bid'].keys())
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 614, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 422, in dict_to_mgr
    index = _extract_index(arrays[~missing])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 625, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2021-08-22 22:17:20,241 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in book
    bids_type = pandas.DataFrame.from_records(_book['bid'])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 2122, in from_records
    mgr = arrays_to_mgr(arrays, arr_columns, result_index, columns, typ=manager)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 119, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 625, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2021-08-22 22:17:21,440 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in book
    bids_type = pandas.DataFrame.from_records(_book['bid'])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 2122, in from_records
    mgr = arrays_to_mgr(arrays, arr_columns, result_index, columns, typ=manager)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 119, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 625, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2021-08-22 22:17:31,847 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in book
    bids_type = pandas.DataFrame.from_records(_book['bid'], index=0)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 2097, in from_records
    i = columns.get_loc(index)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 0
2021-08-22 22:17:33,045 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in book
    bids_type = pandas.DataFrame.from_records(_book['bid'], index=0)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 2097, in from_records
    i = columns.get_loc(index)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 0
2021-08-22 22:17:34,222 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in book
    bids_type = pandas.DataFrame.from_records(_book['bid'], index=0)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 2097, in from_records
    i = columns.get_loc(index)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 0
2021-08-22 22:17:35,401 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in book
    bids_type = pandas.DataFrame.from_records(_book['bid'], index=0)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 2097, in from_records
    i = columns.get_loc(index)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 0
2021-08-22 22:17:36,625 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in book
    bids_type = pandas.DataFrame.from_records(_book['bid'], index=0)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 2097, in from_records
    i = columns.get_loc(index)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 0
2021-08-22 22:18:35,426 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in book
    bids = pandas.DataFrame.from_dict(bids_dict)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 1593, in from_dict
    return cls(data, index=index, columns=columns, dtype=dtype)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 614, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 464, in dict_to_mgr
    return arrays_to_mgr(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 119, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 625, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2021-08-22 22:18:36,639 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in book
    bids = pandas.DataFrame.from_dict(bids_dict)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 1593, in from_dict
    return cls(data, index=index, columns=columns, dtype=dtype)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 614, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 464, in dict_to_mgr
    return arrays_to_mgr(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 119, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 625, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2021-08-22 22:22:29,580 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 53, in book
    json_object = json.dumps(_book, indent=4)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\__init__.py", line 234, in dumps
    return cls(
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 201, in encode
    chunks = list(chunks)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 376, in _iterencode_dict
    raise TypeError(f'keys must be str, int, float, bool or None, '
TypeError: keys must be str, int, float, bool or None, not Decimal
2021-08-22 22:22:30,732 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 53, in book
    json_object = json.dumps(_book, indent=4)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\__init__.py", line 234, in dumps
    return cls(
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 201, in encode
    chunks = list(chunks)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 376, in _iterencode_dict
    raise TypeError(f'keys must be str, int, float, bool or None, '
TypeError: keys must be str, int, float, bool or None, not Decimal
2021-08-22 22:22:31,892 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 53, in book
    json_object = json.dumps(_book, indent=4)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\__init__.py", line 234, in dumps
    return cls(
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 201, in encode
    chunks = list(chunks)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 376, in _iterencode_dict
    raise TypeError(f'keys must be str, int, float, bool or None, '
TypeError: keys must be str, int, float, bool or None, not Decimal
2021-08-22 22:22:33,065 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 53, in book
    json_object = json.dumps(_book, indent=4)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\__init__.py", line 234, in dumps
    return cls(
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 201, in encode
    chunks = list(chunks)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 376, in _iterencode_dict
    raise TypeError(f'keys must be str, int, float, bool or None, '
TypeError: keys must be str, int, float, bool or None, not Decimal
2021-08-22 22:22:34,250 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 53, in book
    json_object = json.dumps(_book, indent=4)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\__init__.py", line 234, in dumps
    return cls(
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 201, in encode
    chunks = list(chunks)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 376, in _iterencode_dict
    raise TypeError(f'keys must be str, int, float, bool or None, '
TypeError: keys must be str, int, float, bool or None, not Decimal
2021-08-22 22:22:35,426 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 53, in book
    json_object = json.dumps(_book, indent=4)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\__init__.py", line 234, in dumps
    return cls(
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 201, in encode
    chunks = list(chunks)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\json\encoder.py", line 376, in _iterencode_dict
    raise TypeError(f'keys must be str, int, float, bool or None, '
TypeError: keys must be str, int, float, bool or None, not Decimal
2021-08-22 22:27:12,599 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 53, in book
    for key, value in _book['bid']:
TypeError: cannot unpack non-iterable decimal.Decimal object
2021-08-22 22:27:13,760 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 53, in book
    for key, value in _book['bid']:
TypeError: cannot unpack non-iterable decimal.Decimal object
2021-08-22 22:27:24,232 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 53, in book
    for key, value in _book['bid']:
TypeError: cannot unpack non-iterable decimal.Decimal object
2021-08-22 22:28:23,403 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 54, in book
    for key, value in bids:
TypeError: cannot unpack non-iterable decimal.Decimal object
2021-08-22 22:28:24,584 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 54, in book
    for key, value in bids:
TypeError: cannot unpack non-iterable decimal.Decimal object
2021-08-22 22:28:25,739 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 54, in book
    for key, value in bids:
TypeError: cannot unpack non-iterable decimal.Decimal object
2021-08-22 22:28:57,529 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 55, in book
    for value in key:
TypeError: 'decimal.Decimal' object is not iterable
2021-08-22 22:28:58,693 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 55, in book
    for value in key:
TypeError: 'decimal.Decimal' object is not iterable
2021-08-22 22:28:59,848 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 55, in book
    for value in key:
TypeError: 'decimal.Decimal' object is not iterable
2021-08-22 22:55:17,066 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 28, in add_book
    self.bids = pandas.DataFrame.from_dict(self.book['bid'])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 1593, in from_dict
    return cls(data, index=index, columns=columns, dtype=dtype)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 614, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 464, in dict_to_mgr
    return arrays_to_mgr(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 119, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 625, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2021-08-22 22:55:18,246 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 31, in add_book
    assert(self.check_master(book))
AssertionError
2021-08-22 22:55:19,440 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 31, in add_book
    assert(self.check_master(book))
AssertionError
2021-08-22 22:55:20,631 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 31, in add_book
    assert(self.check_master(book))
AssertionError
2021-08-22 22:55:21,823 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 31, in add_book
    assert(self.check_master(book))
AssertionError
2021-08-22 22:55:23,011 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 31, in add_book
    assert(self.check_master(book))
AssertionError
2021-08-22 22:55:24,184 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 31, in add_book
    assert(self.check_master(book))
AssertionError
2021-08-22 22:55:26,683 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 28, in add_book
    self.bids = pandas.DataFrame.from_dict(self.book['bid'])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 1593, in from_dict
    return cls(data, index=index, columns=columns, dtype=dtype)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 614, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 464, in dict_to_mgr
    return arrays_to_mgr(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 119, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 625, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2021-08-22 22:55:27,863 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 31, in add_book
    assert(self.check_master(book))
AssertionError
2021-08-22 22:56:35,288 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 28, in add_book
    self.bids = pandas.DataFrame.from_records(self.book['bid'])
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 2122, in from_records
    mgr = arrays_to_mgr(arrays, arr_columns, result_index, columns, typ=manager)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 119, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 625, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2021-08-22 22:56:36,453 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 31, in add_book
    assert(self.check_master(book))
AssertionError
2021-08-22 22:56:37,612 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 31, in add_book
    assert(self.check_master(book))
AssertionError
2021-08-22 22:57:50,472 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 28, in add_book
    self.bids = pandas.DataFrame.from_records(self.book['bid'], index=self.book['bid'].keys())
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 2110, in from_records
    result_index = ensure_index_from_sequences(index_data, names=index)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 6277, in ensure_index_from_sequences
    return MultiIndex.from_arrays(sequences, names=names)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\multi.py", line 475, in from_arrays
    raise TypeError(error_msg)
TypeError: Input must be a list / sequence of array-likes.
2021-08-22 22:57:51,672 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 31, in add_book
    assert(self.check_master(book))
AssertionError
2021-08-22 22:57:52,924 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 31, in add_book
    assert(self.check_master(book))
AssertionError
2021-08-22 22:57:54,083 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 31, in add_book
    assert(self.check_master(book))
AssertionError
2021-08-22 22:57:55,257 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 31, in add_book
    assert(self.check_master(book))
AssertionError
2021-08-22 22:57:56,456 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 31, in add_book
    assert(self.check_master(book))
AssertionError
2021-08-22 23:02:01,387 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 28, in add_book
    self.bids = pandas.DataFrame.from_dict(self.book['bid']).dropna()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 1593, in from_dict
    return cls(data, index=index, columns=columns, dtype=dtype)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 614, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 464, in dict_to_mgr
    return arrays_to_mgr(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 119, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 625, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2021-08-22 23:02:02,551 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 31, in add_book
    assert(self.check_master(book))
AssertionError
2021-08-22 23:02:03,767 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 31, in add_book
    assert(self.check_master(book))
AssertionError
2021-08-22 23:06:21,140 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 30, in add_book
    self.bids.columns = ['price', 'size']
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\generic.py", line 5500, in __setattr__
    return object.__setattr__(self, name, value)
  File "pandas\_libs\properties.pyx", line 70, in pandas._libs.properties.AxisProperty.__set__
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\generic.py", line 766, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\managers.py", line 216, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\base.py", line 57, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 1 elements, new values have 2 elements
2021-08-22 23:06:22,320 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 36, in add_book
    assert (self.check_master(book))
AssertionError
2021-08-22 23:06:23,516 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 36, in add_book
    assert (self.check_master(book))
AssertionError
2021-08-23 10:06:50,062 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 37, in add_book
    for price, size in entry:
ValueError: not enough values to unpack (expected 2, got 1)
2021-08-23 10:06:51,236 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 46, in add_book
    assert (self.check_master(book))
AssertionError
2021-08-23 10:06:51,824 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 37, in add_book
    for price, size in entry:
ValueError: not enough values to unpack (expected 2, got 1)
2021-08-23 10:06:52,419 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 46, in add_book
    assert (self.check_master(book))
AssertionError
2021-08-23 10:06:52,978 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 46, in add_book
    assert (self.check_master(book))
AssertionError
2021-08-23 10:06:53,592 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 46, in add_book
    assert (self.check_master(book))
AssertionError
2021-08-23 10:06:54,164 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 46, in add_book
    assert (self.check_master(book))
AssertionError
2021-08-23 10:07:19,767 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 37, in add_book
    for price, size in entry:
ValueError: not enough values to unpack (expected 2, got 1)
2021-08-23 10:07:20,922 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 45, in add_book
    assert (self.check_master(book))
AssertionError
2021-08-23 10:07:22,104 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 45, in add_book
    assert (self.check_master(book))
AssertionError
2021-08-23 10:08:13,402 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 37, in add_book
    for price, size in book[entry]:
KeyError: 'b'
2021-08-23 10:08:14,690 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 44, in add_book
    assert (self.check_master(book))
AssertionError
2021-08-23 10:09:12,449 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 37, in add_book
    for price, size in book[side]:
TypeError: cannot unpack non-iterable decimal.Decimal object
2021-08-23 10:10:34,737 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 37, in add_book
    for price, size in book[side]:
TypeError: cannot unpack non-iterable decimal.Decimal object
2021-08-23 10:20:34,151 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 41, in add_book
    self.bids = pandas.DataFrame(book['bid']).dropna()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 614, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 464, in dict_to_mgr
    return arrays_to_mgr(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 119, in arrays_to_mgr
    index = _extract_index(arrays)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\internals\construction.py", line 625, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2021-08-23 10:27:29,759 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: ('price', 'bid-size')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 41, in add_book
    bid_book = book_df_reset['price', 'bid-size'].dropna()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: ('price', 'bid-size')
2021-08-23 10:38:12,590 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 42, in add_book
    self.asks = book_df_reset[['price', 'ask-size']].copy().dropna()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 3461, in __getitem__
    indexer = self.loc._get_listlike_indexer(key, axis=1)[1]
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexing.py", line 1314, in _get_listlike_indexer
    self._validate_read_indexer(keyarr, indexer, axis)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexing.py", line 1377, in _validate_read_indexer
    raise KeyError(f"{not_found} not in index")
KeyError: "['ask-size'] not in index"
2021-08-23 13:24:24,250 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 47, in add_book
    self.update_dataframes()
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 40, in update_dataframes
    q.put(self.bids)
NameError: name 'q' is not defined
2021-08-23 13:24:25,570 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 24, in __call__
    await loop.run_in_executor(None, self.callback, *args, **kwargs)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jlove\PycharmProjects\OrderBookTest\main.py", line 50, in add_book
    assert (self.check_master(book))
AssertionError
2021-08-23 14:58:18,195 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 368, in message_handler
    await self._pair_level2_update(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 206, in _pair_level2_update
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, False, delta, ts, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 216, in book_callback
    await self.callback(BOOK_DELTA, feed=self.id, symbol=symbol, delta=delta, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 73, in __call__
    await super().__call__(feed, symbol, delta, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 46, in update_book
    self.flat_book()
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 49, in flat_book
    list = _util.book_flatten(self.book)
TypeError: book_flatten() missing 4 required positional arguments: 'symbol', 'book', 'timestamp', and 'delta'
2021-08-23 14:58:19,407 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 36, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-23 14:58:20,617 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 36, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-23 14:59:48,648 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 368, in message_handler
    await self._pair_level2_update(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 206, in _pair_level2_update
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, False, delta, ts, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 216, in book_callback
    await self.callback(BOOK_DELTA, feed=self.id, symbol=symbol, delta=delta, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 73, in __call__
    await super().__call__(feed, symbol, delta, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 46, in update_book
    self.flat_book()
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 49, in flat_book
    struct = _util.book_flatten(self.book)
TypeError: book_flatten() missing 4 required positional arguments: 'symbol', 'book', 'timestamp', and 'delta'
2021-08-23 15:01:08,884 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 368, in message_handler
    await self._pair_level2_update(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 206, in _pair_level2_update
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, False, delta, ts, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 216, in book_callback
    await self.callback(BOOK_DELTA, feed=self.id, symbol=symbol, delta=delta, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 73, in __call__
    await super().__call__(feed, symbol, delta, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 46, in update_book
    self.flat_book()
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in flat_book
    _util.book_convert(self.book, struct)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\backends\_util.py", line 40, in book_convert
    data[ASK][_level] = convert(book[ASK][level])
KeyError: 'ask'
2021-08-23 15:02:05,308 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 368, in message_handler
    await self._pair_level2_update(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 206, in _pair_level2_update
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, False, delta, ts, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 216, in book_callback
    await self.callback(BOOK_DELTA, feed=self.id, symbol=symbol, delta=delta, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 73, in __call__
    await super().__call__(feed, symbol, delta, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 46, in update_book
    self.flat_book()
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in flat_book
    _util.book_delta_convert(self.book, struct)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\backends\_util.py", line 15, in book_delta_convert
    if len(entry) == 2:
TypeError: object of type 'decimal.Decimal' has no len()
2021-08-23 15:02:06,567 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 36, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-23 15:03:40,562 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 368, in message_handler
    await self._pair_level2_update(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 206, in _pair_level2_update
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, False, delta, ts, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 216, in book_callback
    await self.callback(BOOK_DELTA, feed=self.id, symbol=symbol, delta=delta, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 73, in __call__
    await super().__call__(feed, symbol, delta, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 46, in update_book
    self.flat_book()
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in flat_book
    _util.book_convert(self.book, struct, convert=str)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\backends\_util.py", line 40, in book_convert
    data[ASK][_level] = convert(book[ASK][level])
KeyError: 'ask'
2021-08-23 15:05:43,587 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 368, in message_handler
    await self._pair_level2_update(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 206, in _pair_level2_update
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, False, delta, ts, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 216, in book_callback
    await self.callback(BOOK_DELTA, feed=self.id, symbol=symbol, delta=delta, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 73, in __call__
    await super().__call__(feed, symbol, delta, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 46, in update_book
    new_book = _util.book_flatten(feed, symbol, self.book, timestamp)
TypeError: book_flatten() missing 1 required positional argument: 'delta'
2021-08-23 15:22:47,695 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 368, in message_handler
    await self._pair_level2_update(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 206, in _pair_level2_update
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, False, delta, ts, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 216, in book_callback
    await self.callback(BOOK_DELTA, feed=self.id, symbol=symbol, delta=delta, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 73, in __call__
    await super().__call__(feed, symbol, delta, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 47, in update_book
    new_df = pandas.DataFrame(self.flatten_book())
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 730, in __init__
    raise ValueError("DataFrame constructor not properly called!")
ValueError: DataFrame constructor not properly called!
2021-08-23 15:22:48,931 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 37, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-23 15:22:50,141 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 37, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-23 15:23:32,370 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 368, in message_handler
    await self._pair_level2_update(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 206, in _pair_level2_update
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, False, delta, ts, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 216, in book_callback
    await self.callback(BOOK_DELTA, feed=self.id, symbol=symbol, delta=delta, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 73, in __call__
    await super().__call__(feed, symbol, delta, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 48, in update_book
    new_df = pandas.DataFrame(list_book)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 730, in __init__
    raise ValueError("DataFrame constructor not properly called!")
ValueError: DataFrame constructor not properly called!
2021-08-23 15:23:33,591 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 37, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:14:29,144 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 54, in add_book
    self.flatten_book()
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 78, in flatten_book
    bid_low = self.bids[0]
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 0
2021-08-24 11:14:30,583 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:14:32,004 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:14:33,338 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:14:34,587 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:14:45,581 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:14:47,000 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:14:48,316 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:14:49,631 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:14:51,987 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 54, in add_book
    self.flatten_book()
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 78, in flatten_book
    bid_low = self.bids[0]
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 0
2021-08-24 11:14:53,182 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:14:54,451 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:14:55,602 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:14:56,826 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:14:58,009 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:14:59,240 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:15:00,435 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:15:01,626 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:15:02,853 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:15:07,827 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 51, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:15:10,274 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 53, in add_book
    self.flatten_book()
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 77, in flatten_book
    bid_low = self.bids[0]
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\frame.py", line 3455, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 0
2021-08-24 11:15:11,480 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:15:12,651 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:15:17,283 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:15:18,447 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:15:19,623 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-24 11:15:20,859 : ERROR : COINBASE.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 50, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:36:46,200 : WARNING : COINBASE.ws.4: encountered connection issue code = 1006 (connection closed abnormally [internal]), no reason - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 750, in transfer_data
    message = await self.read_message()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 819, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 895, in read_data_frame
    frame = await self.read_frame(max_size)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 971, in read_frame
    frame = await Frame.read(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\framing.py", line 85, in read
    data = await reader(length)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\streams.py", line 723, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\streams.py", line 513, in _wait_for_data
    self._transport.resume_reading()
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\sslproto.py", line 344, in resume_reading
    self._ssl_protocol._transport.resume_reading()
AttributeError: 'NoneType' object has no attribute 'resume_reading'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 113, in _handler
    async for message in connection.read():
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 302, in read
    async for data in self.conn:
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 356, in __aiter__
    yield await self.recv()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 421, in recv
    await self.ensure_open()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 726, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: code = 1006 (connection closed abnormally [internal]), no reason
2021-08-25 11:37:50,828 : WARNING : COINBASE.ws.5: encountered connection issue code = 1006 (connection closed abnormally [internal]), no reason - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 750, in transfer_data
    message = await self.read_message()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 819, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 895, in read_data_frame
    frame = await self.read_frame(max_size)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 971, in read_frame
    frame = await Frame.read(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\framing.py", line 55, in read
    data = await reader(2)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\streams.py", line 723, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\streams.py", line 517, in _wait_for_data
    await self._waiter
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\proactor_events.py", line 395, in _loop_writing
    self._write_fut = self._loop._proactor.send(self._sock, data)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\windows_events.py", line 528, in send
    ov.WSASend(conn.fileno(), buf, flags)
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 113, in _handler
    async for message in connection.read():
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 302, in read
    async for data in self.conn:
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 356, in __aiter__
    yield await self.recv()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 421, in recv
    await self.ensure_open()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 726, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: code = 1006 (connection closed abnormally [internal]), no reason
2021-08-25 11:38:06,055 : ERROR : COINBASE.ws.4: encountered an exception, reconnecting in 2.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\client.py", line 192, in read_http_response
    status_code, reason, headers = await read_response(self.reader)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\http.py", line 112, in read_response
    status_line = await read_line(stream)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\http.py", line 186, in read_line
    line = await stream.readline()
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\streams.py", line 540, in readline
    line = await self.readuntil(sep)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\streams.py", line 632, in readuntil
    await self._wait_for_data('readuntil')
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\streams.py", line 517, in _wait_for_data
    await self._waiter
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\proactor_events.py", line 395, in _loop_writing
    self._write_fut = self._loop._proactor.send(self._sock, data)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\windows_events.py", line 528, in send
    ov.WSASend(conn.fileno(), buf, flags)
ConnectionAbortedError: [WinError 10053] An established connection was aborted by the software in your host machine

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 58, in _create_connection
    async with self.conn.connect() as connection:
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\contextlib.py", line 171, in __aenter__
    return await self.gen.__anext__()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 114, in connect
    await self._open()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 287, in _open
    self.conn = await websockets.connect(self.address, **self.ws_kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\client.py", line 629, in __await_impl__
    await protocol.handshake(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\client.py", line 382, in handshake
    status_code, response_headers = await self.read_http_response()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\client.py", line 198, in read_http_response
    raise InvalidMessage("did not receive a valid HTTP response") from exc
websockets.exceptions.InvalidMessage: did not receive a valid HTTP response
2021-08-25 11:39:01,377 : WARNING : COINBASE.ws.5: encountered connection issue  - reconnecting in 2.0 seconds...
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 58, in _create_connection
    async with self.conn.connect() as connection:
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\contextlib.py", line 171, in __aenter__
    return await self.gen.__anext__()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 114, in connect
    await self._open()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 287, in _open
    self.conn = await websockets.connect(self.address, **self.ws_kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\client.py", line 622, in __await_impl__
    transport, protocol = await self._create_connection()
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\base_events.py", line 1050, in create_connection
    transport, protocol = await self._create_connection_transport(
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\base_events.py", line 1080, in _create_connection_transport
    await waiter
ConnectionResetError
2021-08-25 11:39:01,404 : WARNING : COINBASE.ws.4: encountered connection issue  - reconnecting in 4.0 seconds...
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 58, in _create_connection
    async with self.conn.connect() as connection:
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\contextlib.py", line 171, in __aenter__
    return await self.gen.__anext__()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 114, in connect
    await self._open()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 287, in _open
    self.conn = await websockets.connect(self.address, **self.ws_kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\client.py", line 622, in __await_impl__
    transport, protocol = await self._create_connection()
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\base_events.py", line 1050, in create_connection
    transport, protocol = await self._create_connection_transport(
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\base_events.py", line 1080, in _create_connection_transport
    await waiter
ConnectionResetError
2021-08-25 11:39:54,928 : WARNING : COINBASE.ws.4: encountered connection issue  - reconnecting in 8.0 seconds...
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 58, in _create_connection
    async with self.conn.connect() as connection:
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\contextlib.py", line 171, in __aenter__
    return await self.gen.__anext__()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 114, in connect
    await self._open()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 287, in _open
    self.conn = await websockets.connect(self.address, **self.ws_kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\client.py", line 622, in __await_impl__
    transport, protocol = await self._create_connection()
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\base_events.py", line 1050, in create_connection
    transport, protocol = await self._create_connection_transport(
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\base_events.py", line 1080, in _create_connection_transport
    await waiter
ConnectionResetError
2021-08-25 11:39:54,930 : WARNING : COINBASE.ws.5: encountered connection issue  - reconnecting in 4.0 seconds...
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 58, in _create_connection
    async with self.conn.connect() as connection:
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\contextlib.py", line 171, in __aenter__
    return await self.gen.__anext__()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 114, in connect
    await self._open()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 287, in _open
    self.conn = await websockets.connect(self.address, **self.ws_kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\client.py", line 622, in __await_impl__
    transport, protocol = await self._create_connection()
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\base_events.py", line 1050, in create_connection
    transport, protocol = await self._create_connection_transport(
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\base_events.py", line 1080, in _create_connection_transport
    await waiter
ConnectionResetError
2021-08-25 11:39:59,541 : WARNING : COINBASE.ws.3: encountered connection issue code = 1006 (connection closed abnormally [internal]), no reason - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 750, in transfer_data
    message = await self.read_message()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 819, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 895, in read_data_frame
    frame = await self.read_frame(max_size)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 971, in read_frame
    frame = await Frame.read(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\framing.py", line 85, in read
    data = await reader(length)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\streams.py", line 723, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\streams.py", line 517, in _wait_for_data
    await self._waiter
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\proactor_events.py", line 299, in _loop_reading
    self._read_fut = self._loop._proactor.recv(self._sock, 32768)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\windows_events.py", line 445, in recv
    ov.WSARecv(conn.fileno(), nbytes, flags)
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 113, in _handler
    async for message in connection.read():
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 302, in read
    async for data in self.conn:
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 356, in __aiter__
    yield await self.recv()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 421, in recv
    await self.ensure_open()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 726, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: code = 1006 (connection closed abnormally [internal]), no reason
2021-08-25 11:39:59,597 : WARNING : COINBASE.ws.5: received no messages within timeout, restarting connection
2021-08-25 11:39:59,753 : ERROR : COINBASE.ws.5: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:40:00,855 : ERROR : COINBASE.ws.3: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:40:01,005 : ERROR : COINBASE.ws.5: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:40:02,101 : ERROR : COINBASE.ws.3: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:40:02,214 : ERROR : COINBASE.ws.5: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:40:03,012 : WARNING : COINBASE.ws.4: received no messages within timeout, restarting connection
2021-08-25 11:41:13,046 : WARNING : COINBASE.ws.3: encountered connection issue code = 1006 (connection closed abnormally [internal]), no reason - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 750, in transfer_data
    message = await self.read_message()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 819, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 895, in read_data_frame
    frame = await self.read_frame(max_size)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 971, in read_frame
    frame = await Frame.read(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\framing.py", line 85, in read
    data = await reader(length)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\streams.py", line 723, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\streams.py", line 513, in _wait_for_data
    self._transport.resume_reading()
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\sslproto.py", line 344, in resume_reading
    self._ssl_protocol._transport.resume_reading()
AttributeError: 'NoneType' object has no attribute 'resume_reading'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 113, in _handler
    async for message in connection.read():
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 302, in read
    async for data in self.conn:
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 356, in __aiter__
    yield await self.recv()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 421, in recv
    await self.ensure_open()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 726, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: code = 1006 (connection closed abnormally [internal]), no reason
2021-08-25 11:41:15,540 : WARNING : COINBASE.ws.4: encountered connection issue code = 1006 (connection closed abnormally [internal]), no reason - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 750, in transfer_data
    message = await self.read_message()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 819, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 895, in read_data_frame
    frame = await self.read_frame(max_size)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 971, in read_frame
    frame = await Frame.read(
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\framing.py", line 55, in read
    data = await reader(2)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\streams.py", line 723, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\streams.py", line 517, in _wait_for_data
    await self._waiter
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\proactor_events.py", line 299, in _loop_reading
    self._read_fut = self._loop._proactor.recv(self._sock, 32768)
  File "C:\Users\jlove\AppData\Local\Programs\Python\Python38\lib\asyncio\windows_events.py", line 445, in recv
    ov.WSARecv(conn.fileno(), nbytes, flags)
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 113, in _handler
    async for message in connection.read():
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection.py", line 302, in read
    async for data in self.conn:
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 356, in __aiter__
    yield await self.recv()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 421, in recv
    await self.ensure_open()
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\websockets\legacy\protocol.py", line 726, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: code = 1006 (connection closed abnormally [internal]), no reason
2021-08-25 11:41:15,818 : ERROR : COINBASE.ws.3: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:41:16,724 : ERROR : COINBASE.ws.4: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:41:17,049 : ERROR : COINBASE.ws.3: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:41:17,959 : ERROR : COINBASE.ws.4: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:41:18,276 : ERROR : COINBASE.ws.3: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:41:19,126 : ERROR : COINBASE.ws.4: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:41:19,535 : ERROR : COINBASE.ws.3: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:41:20,342 : ERROR : COINBASE.ws.4: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:41:20,832 : ERROR : COINBASE.ws.3: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:41:21,676 : ERROR : COINBASE.ws.4: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:41:22,106 : ERROR : COINBASE.ws.3: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:41:22,888 : ERROR : COINBASE.ws.4: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:41:23,359 : ERROR : COINBASE.ws.3: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:41:24,065 : ERROR : COINBASE.ws.4: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:41:24,644 : ERROR : COINBASE.ws.3: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
2021-08-25 11:41:25,252 : ERROR : COINBASE.ws.4: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 68, in _create_connection
    await self._handler(connection, self.handler)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\connection_handler.py", line 117, in _handler
    await handler(message, connection, self.conn.last_message)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 366, in message_handler
    await self._pair_level2_snapshot(msg, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\exchanges\coinbase.py", line 187, in _pair_level2_snapshot
    await self.book_callback(self._l2_book[pair], L2_BOOK, pair, True, None, timestamp, timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 235, in book_callback
    await self.callback(L2_BOOK, feed=self.id, symbol=symbol, book=book, timestamp=timestamp, receipt_timestamp=receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\feed.py", line 249, in callback
    await cb(**kwargs)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 57, in __call__
    await super().__call__(feed, symbol, book, timestamp, receipt_timestamp)
  File "C:\Users\jlove\.virtualenvs\OrderBookTest\lib\site-packages\cryptofeed\callback.py", line 21, in __call__
    await self.callback(*args, **kwargs)
  File "C:/Users/jlove/PycharmProjects/OrderBookTest/main.py", line 71, in add_book
    assert (self.check_books(book))
AssertionError
